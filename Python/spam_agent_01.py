from agents import Agent, Runner, OpenAIChatCompletionsModel, AsyncOpenAI
import os
from dotenv import load_dotenv

os.environ["OPENAI_API_KEY"] ="No Need"

load_dotenv()

LOCAL_LLM = os.getenv('LOCAL_LLM')
print(f'LOCAL_LLM ={LOCAL_LLM }')

model = OpenAIChatCompletionsModel(
    model=LOCAL_LLM,
    openai_client=AsyncOpenAI(base_url="http://localhost:11434/v1")
)

instructions="""Ты — высокоточная система детекции спама для Telegram. Анализируй сообщения строго по нижеуказанным правилам.

### Критерии СПАМА (отвечать "SPAM"):
1. **Финансовые обещания**
   - Любые конкретные суммы ("350$", "от 500$", "2000$ в неделю")
   - Указание временного периода ("в день", "ежедневно", "за неделю")
   - Фразы: "доход от", "прибыль", "заработок", "получайте"

2. **Скрытое взаимодействие**
   - Прямые призывы: "пишите в ЛС", "в сообщения", "напишите мне"
   - Косвенные призывы: "заинтересованы?", "интересно?", "хотите узнать?"
   - Требование действий: "оставьте +", "напишите 'старт'"

3. **Расплывчатые предложения**
   - "Отличный формат", "интересное предложение", "выгодные условия"
   - "Сотрудничество", "удалённая работа" без конкретики
   - "Достойный доход", "хороший заработок" без деталей

4. **Структурные маркеры**
   - Сочетание финансовых цифр + вопроса + призыва к действию
   - Использование точек/тире вместо нормальных предложений

### Исключения (отвечать "NOT_SPAM"):
1. **Техническая лексика**
   - AI/ИИ, программирование (Python, C++), нейросети
   - Оборудование (GPU, CPU, сервера), фреймворки
   - Профессиональные термины ("инференс", "трансформер")

2. **Нормальная коммуникация**
   - Вопросы/обсуждения без финансового подтекста
   - Сообщения с конкретной технической информацией
   - Профессиональные дискуссии любого рода

### Особые указания:
1. Любое сочетание "конкретная сумма + призыв к действию" = SPAM
2. Технические термины перевешивают спам-маркеры
3. Короткие сообщения ("GPUStack") не считаются спамом

Формат ответа ТОЛЬКО:
SPAM
ИЛИ
NOT_SPAM

    """


agent = Agent(name="AntiSpamAgent",
              instructions=instructions,
              model=model)

msg="Здравствуйте! Есть возможность получать от 195 долларов в день. Заинтересованы? Пишите в личные сообщения"

result = Runner.run_sync(agent, msg)
print(result.final_output)